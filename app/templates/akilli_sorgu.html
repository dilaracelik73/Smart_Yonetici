{% extends "layout.html" %}
{% block title %}Akıllı Sorgu Sistemi - SmartYönetici{% endblock %}

{% block content %}

<!-- Sayfa Başlığı -->
<div class="mb-4 p-4 rounded-4 shadow-sm d-flex align-items-center justify-content-between"
     style="background: linear-gradient(90deg, #e3f2fd 0%, #bbdefb 50%, #d1c4e9 100%); border-left: 6px solid #3f51b5;">
  <div class="d-flex align-items-center">
    <div class="me-3 d-flex align-items-center justify-content-center rounded-circle"
         style="width:60px; height:60px; background:#3f51b5; color:#fff; font-size:1.6rem;">
      <i class="fas fa-search"></i>
    </div>
    <div>
      <h2 class="fw-bold text-dark mb-1">Akıllı Sorgu Sistemi</h2>
      <p class="mb-0 text-muted" style="font-size:0.95rem;">
        Doğal dilde sorunuzu yazın, yapay zekâ analiz etsin ve size en uygun cevabı versin.
      </p>
    </div>
  </div>
</div>


<div class="row g-4 align-items-stretch">
    <!-- AI Asistan Kutusu -->
    <div class="col-md-8">
        <div class="ai-assistant-box h-100 shadow-lg rounded-4 d-flex flex-column">
            <!-- Header -->
            <div class="ai-header d-flex align-items-center">
                <div class="ai-icon">
                    <i class="fas fa-robot"></i>
                </div>
                <h5 class="fw-bold mb-0">SmartYönetici AI Asistanı</h5>
            </div>

            <!-- İçerik -->
            <div class="p-4 text-dark flex-grow-1 d-flex flex-column">
                <p class="mb-3">Merhaba! Ben SmartYönetici AI asistanınızım. Size aşağıdaki konularda yardımcı olabilirim:</p>
                <ul class="mb-4">
                    <li>Aidat ödemeleri ve gecikmeler</li>
                    <li>Şikayet analizi ve çözüm önerileri</li>
                    <li>Finansal raporlar ve tahminler</li>
                    <li>Duyuru oluşturma</li>
                    <li>Genel bina yönetimi soruları</li>
                </ul>

                <!-- Soru Cevap Formu -->
                <form method="POST" class="mt-auto">
                    <textarea name="soru" id="soruTextarea" required 
                        class="form-control shadow-sm rounded-3 mb-3"
                        placeholder="Sormak istediğiniz şeyi yazın..."></textarea>
                    <button type="submit" class="btn btn-primary w-100 fw-semibold shadow-sm">
                        <i class="fas fa-paper-plane me-2"></i> Sor
                    </button>
                </form>

                {% if cevap %}
                <div class="alert alert-info mt-4 shadow-sm rounded-3">
                    <strong>Yanıt:</strong> {{ cevap }}
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Sağ Panel -->
    <div class="col-md-4">
        <div class="card shadow-sm border-0 rounded-4 h-100 d-flex flex-column">
            <div class="card-header fw-bold bg-primary text-white rounded-top-4">
                <i class="fas fa-lightbulb me-2"></i> Örnek Sorular
            </div>
            <div class="card-body d-grid gap-2 flex-grow-1">
                {% set ornek_sorular = [
                    "Merhaba, nasılsın?",
                    "Bu ay toplam kaç aidat ödemesi yapıldı?",
                    "Hangi kategoride en çok şikayet var?",
                    "Son 3 ayın gider analizi nasıl?",
                    "Hadi biraz sohbet edelim.",
                ] %}
                {% for soru in ornek_sorular %}
                <button type="button" class="btn btn-outline-primary btn-sm text-start soru-btn"
                        onclick="fillSoru('{{ soru }}')">
                    <i class="fas fa-question-circle me-2"></i> {{ soru }}
                </button>
                {% endfor %}
            </div>
        </div>
    </div>
</div>

<style>
.ai-assistant-box {
    background: linear-gradient(180deg, #e3f2fd 0%, #ffffff 50%, #f5f7fa 100%);
    border: 1px solid #dce3f0;
    transition: transform 0.25s ease, box-shadow 0.25s ease;
}
.ai-assistant-box:hover {
    transform: translateY(-4px);
    box-shadow: 0 10px 28px rgba(0,0,0,0.15);
}
.ai-header {
    background: linear-gradient(90deg, #3f51b5, #5c6bc0);
    color: white;
    padding: 1rem;
    border-top-left-radius: 1rem;
    border-top-right-radius: 1rem;
    font-size: 1.1rem;
}
.ai-icon {
    background: white;
    color: #3f51b5;
    width: 45px;
    height: 45px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 12px;
    font-size: 1.4rem;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}
.ai-header h5 {
    font-weight: 600;
}
.soru-btn {
    border-radius: 0.6rem;
    transition: all 0.25s ease-in-out;
    font-size: 0.9rem;
    font-weight: 500;
}
.soru-btn:hover {
    background: linear-gradient(90deg, #42a5f5, #478ed1);
    color: white !important;
    transform: translateX(4px);
    box-shadow: 0 4px 12px rgba(66,165,245,0.3);
}
</style>

<!-- İstatistikler -->
<div class="row g-4 mt-4">
    {% set stats = [
        {"icon": "fa-comment-dots", "color": "info", "value": toplam_sorgu, "label": "Toplam Sorgu"},
        {"icon": "fa-percentage", "color": "success", "value": dogruluk_orani ~ '%', "label": "Doğruluk Oranı"},
        {"icon": "fa-clock", "color": "primary", "value": ortalama_sure ~ 's', "label": "Ortalama Yanıt Süresi"},
        {"icon": "fa-smile", "color": "warning", "value": ortalama_memnuniyet ~ '/5', "label": "Kullanıcı Memnuniyeti"}
    ] %}
    {% for stat in stats %}
    <div class="col-md-6 col-xl-3">
        <div class="card shadow rounded-4 text-center border-0 dashboard-card h-100">
            <div class="card-body py-4">
                <div class="icon-circle mb-3 bg-{{ stat.color }} bg-gradient">
                    <i class="fas {{ stat.icon }} fa-2x text-white"></i>
                </div>
                <h5 class="card-title fw-semibold text-{{ stat.color }}">{{ stat.label }}</h5>
                <p class="fs-3 fw-bold text-{{ stat.color }}">{{ stat.value }}</p>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

<style>
.dashboard-card {
    transition: transform 0.25s ease, box-shadow 0.25s ease;
    border-radius: 1rem !important;
}
.dashboard-card:hover {
    transform: translateY(-6px) scale(1.04);
    box-shadow: 0 10px 28px rgba(0,0,0,0.15);
}
.icon-circle {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 15px rgba(0,0,0,0.10);
}
</style>

<script>
    function fillSoru(text) {
        const textarea = document.getElementById("soruTextarea");
        if (textarea) {
            textarea.value = text;
            textarea.focus();
        }
    }
</script>

{% endblock %}
